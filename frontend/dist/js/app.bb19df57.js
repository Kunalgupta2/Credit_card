(function(){"use strict";var e={5399:function(e,t,o){var r=o(3751),a=o(641);const s={id:"app"};function n(e,t,o,r,n,i){const d=(0,a.g2)("router-view");return(0,a.uX)(),(0,a.CE)("div",s,[(0,a.bF)(d)])}var i={name:"App"},d=o(6262);const l=(0,d.A)(i,[["render",n]]);var u=l,c=o(5220),p=o(4335);const h=p.A.create({baseURL:"http://localhost:8000"});h.interceptors.request.use((e=>{const t=localStorage.getItem("access_token");return t&&(e.headers["Authorization"]=`Bearer ${t}`),e}),(e=>Promise.reject(e)));var m=h;const g=(0,a.Lk)("h2",null,"Login",-1),f=(0,a.Lk)("button",{type:"submit"},"Login",-1);function v(e,t,o,s,n,i){return(0,a.uX)(),(0,a.CE)("div",null,[g,(0,a.Lk)("form",{onSubmit:t[3]||(t[3]=(0,r.D$)(((...e)=>i.login&&i.login(...e)),["prevent"]))},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.username=e),type:"text",placeholder:"Username",required:""},null,512),[[r.Jo,n.username]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>n.password=e),type:"password",placeholder:"Password",required:""},null,512),[[r.Jo,n.password]]),f,(0,a.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>i.loginWithGoogle&&i.loginWithGoogle(...e))},"Login with Google")],32)])}o(4114);var y={data(){return{username:"",password:""}},methods:{async login(){try{const e=new FormData;e.append("username",this.username),e.append("password",this.password);const t=await m.post("/login",e,{headers:{"Content-Type":"application/x-www-form-urlencoded"}});localStorage.setItem("access_token",t.data.access_token),this.$router.push("/user-details")}catch(e){console.error("Login error:",e.response?.data?.detail||e.message),alert("Login failed: "+(e.response?.data?.detail||"Unknown error"))}},loginWithGoogle(){window.location.href="/login/google"}}};const b=(0,d.A)(y,[["render",v]]);var k=b;const L=(0,a.Lk)("h2",null,"Register",-1),w=(0,a.Lk)("button",{type:"submit"},"Register",-1);function U(e,t,o,s,n,i){return(0,a.uX)(),(0,a.CE)("div",null,[L,(0,a.Lk)("form",{onSubmit:t[4]||(t[4]=(0,r.D$)(((...e)=>i.register&&i.register(...e)),["prevent"]))},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.username=e),type:"text",placeholder:"Username",required:""},null,512),[[r.Jo,n.username]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>n.email=e),type:"email",placeholder:"Email",required:""},null,512),[[r.Jo,n.email]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>n.password=e),type:"password",placeholder:"Password",required:""},null,512),[[r.Jo,n.password]]),w,(0,a.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>i.loginWithGoogle&&i.loginWithGoogle(...e))},"Register with Google")],32)])}var _={data(){return{username:"",email:"",password:""}},methods:{async register(){try{const e=await m.post("/new_user",{username:this.username,email:this.email,hashed_password:this.password});localStorage.setItem("session_id",e.data.session_id),this.$router.push("/verify-otp")}catch(e){console.error("Registration error:",e.response?.data?.detail||e.message),alert("Registration failed: "+(e.response?.data?.detail||"Unknown error"))}},loginWithGoogle(){window.location.href="/login/google"}}};const C=(0,d.A)(_,[["render",U]]);var E=C,P=o(33);const D=e=>((0,a.Qi)("data-v-137b4274"),e=e(),(0,a.jt)(),e),A={class:"user-dashboard"},S=D((()=>(0,a.Lk)("h1",null,"User Dashboard",-1))),I={key:0},O=D((()=>(0,a.Lk)("h2",null,"Your Card Details",-1))),$={key:1},x=D((()=>(0,a.Lk)("p",null,"You don't have a card yet.",-1))),T=["disabled"],V={key:2,class:"error"};function q(e,t,o,r,s,n){return(0,a.uX)(),(0,a.CE)("div",A,[S,s.cardDetails?((0,a.uX)(),(0,a.CE)("div",I,[O,(0,a.Lk)("p",null,"Card Number: "+(0,P.v_)(s.cardDetails.card_number),1),(0,a.Lk)("p",null,"Expiry Date: "+(0,P.v_)(s.cardDetails.expiry_date),1),(0,a.Lk)("p",null,"CVV: "+(0,P.v_)(s.cardDetails.cvv),1),(0,a.Lk)("p",null,"Spending Limit: $"+(0,P.v_)(s.cardDetails.spending_limit),1)])):((0,a.uX)(),(0,a.CE)("div",$,[x,(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>n.createCard&&n.createCard(...e)),disabled:s.isLoading},(0,P.v_)(s.isLoading?"Creating Card...":"Create Card"),9,T)])),s.error?((0,a.uX)(),(0,a.CE)("p",V,(0,P.v_)(s.error),1)):(0,a.Q3)("",!0)])}var F={name:"UserDashboard",data(){return{cardDetails:null,isLoading:!1,error:null}},methods:{async createCard(){this.isLoading=!0,this.error=null;try{const e=localStorage.getItem("access_token"),t=await m.post("/user_creditcard",{},{headers:{Authorization:`Bearer ${e}`}});this.cardDetails=t.data}catch(e){console.error("Error creating card:",e),this.error=e.response?.data?.detail||"An error occurred while creating the card."}finally{this.isLoading=!1}}}};const j=(0,d.A)(F,[["render",q],["__scopeId","data-v-137b4274"]]);var J=j;const N=(0,a.Lk)("h2",null,"Add User Details",-1),X=(0,a.Lk)("option",{disabled:"",value:""},"Select Gender",-1),R=(0,a.Lk)("option",{value:"male"},"Male",-1),B=(0,a.Lk)("option",{value:"female"},"Female",-1),G=(0,a.Lk)("option",{value:"other"},"Other",-1),M=[X,R,B,G],Q=(0,a.Lk)("button",{type:"submit"},"Submit Details",-1);function W(e,t,o,s,n,i){return(0,a.uX)(),(0,a.CE)("div",null,[N,(0,a.Lk)("form",{onSubmit:t[5]||(t[5]=(0,r.D$)(((...e)=>i.addUserDetails&&i.addUserDetails(...e)),["prevent"]))},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.firstName=e),type:"text",placeholder:"First Name",required:""},null,512),[[r.Jo,n.firstName]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>n.lastName=e),type:"text",placeholder:"Last Name",required:""},null,512),[[r.Jo,n.lastName]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>n.phoneNumber=e),type:"text",placeholder:"Phone Number",required:""},null,512),[[r.Jo,n.phoneNumber]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>n.dateOfBirth=e),type:"date",placeholder:"Date of Birth",required:""},null,512),[[r.Jo,n.dateOfBirth]]),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>n.gender=e),required:""},M,512),[[r.u1,n.gender]]),Q],32),(0,a.Lk)("button",{onClick:t[6]||(t[6]=e=>this.$router.push("/dashboard"))},"Back to Dashboard")])}var z={data(){return{firstName:"",lastName:"",phoneNumber:"",dateOfBirth:"",gender:""}},methods:{async addUserDetails(){try{const e=localStorage.getItem("access_token"),t={first_name:this.firstName,last_name:this.lastName,phone_number:this.phoneNumber,date_of_birth:this.dateOfBirth,gender:this.gender};console.log("Sending user data:",t);const o=await m.post("/user_details",t,{headers:{Authorization:`Bearer ${e}`}});console.log("Response:",o.data),alert("User details added successfully!"),this.$router.push("/user-address")}catch(e){console.error("Error adding user details:",e),console.error("Error response:",e.response),console.error("Error data:",e.response?.data),alert("Failed to add user details: "+(e.response?.data?.detail||"Unknown error"))}}}};const Y=(0,d.A)(z,[["render",W]]);var H=Y;const K=e=>((0,a.Qi)("data-v-2253b8ec"),e=e(),(0,a.jt)(),e),Z=K((()=>(0,a.Lk)("h2",null,"Add User Address",-1))),ee=K((()=>(0,a.Lk)("button",{type:"submit"},"Submit Address",-1)));function te(e,t,o,s,n,i){return(0,a.uX)(),(0,a.CE)("div",null,[Z,(0,a.Lk)("form",{onSubmit:t[5]||(t[5]=(0,r.D$)(((...e)=>i.addUserAddress&&i.addUserAddress(...e)),["prevent"]))},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.address=e),type:"text",placeholder:"Address",required:""},null,512),[[r.Jo,n.address]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>n.city=e),type:"text",placeholder:"City",required:""},null,512),[[r.Jo,n.city]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>n.state=e),type:"text",placeholder:"State",required:""},null,512),[[r.Jo,n.state]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>n.country=e),type:"text",placeholder:"Country",required:""},null,512),[[r.Jo,n.country]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>n.postalCode=e),type:"text",placeholder:"Postal Code",required:""},null,512),[[r.Jo,n.postalCode]]),ee],32)])}var oe={data(){return{address:"",city:"",state:"",country:"",postalCode:""}},methods:{async addUserAddress(){try{const e=localStorage.getItem("access_token"),t=await m.post("/user_address",{address:this.address,city:this.city,state:this.state,country:this.country,postal_code:this.postalCode},{headers:{Authorization:`Bearer ${e}`}});console.log(t.data),alert("User address added successfully!"),this.$router.push("/user-income")}catch(e){console.error("Error adding user address:",e.response?.data?.detail||e.message),alert("Failed to add user address: "+(e.response?.data?.detail||"Unknown error"))}}}};const re=(0,d.A)(oe,[["render",te],["__scopeId","data-v-2253b8ec"]]);var ae=re;const se=e=>((0,a.Qi)("data-v-6e0251a2"),e=e(),(0,a.jt)(),e),ne=se((()=>(0,a.Lk)("h2",null,"Add User Income",-1))),ie=se((()=>(0,a.Lk)("button",{type:"submit"},"Submit Income",-1)));function de(e,t,o,s,n,i){return(0,a.uX)(),(0,a.CE)("div",null,[ne,(0,a.Lk)("form",{onSubmit:t[1]||(t[1]=(0,r.D$)(((...e)=>i.addUserIncome&&i.addUserIncome(...e)),["prevent"]))},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.annualIncome=e),type:"number",placeholder:"Annual Income",required:""},null,512),[[r.Jo,n.annualIncome]]),ie],32)])}var le={data(){return{annualIncome:""}},methods:{async addUserIncome(){try{const e=await m.post("/user_income",{Annual_Income:this.annualIncome.toString()});console.log("Response:",e.data),alert("User income added successfully!"),this.$router.push("/user-document")}catch(e){console.error("Error adding user income:",e),console.error("Error response:",e.response),console.error("Error data:",e.response?.data),alert("Failed to add user income: "+(e.response?.data?.detail||"Unknown error"))}}}};const ue=(0,d.A)(le,[["render",de],["__scopeId","data-v-6e0251a2"]]);var ce=ue;const pe=e=>((0,a.Qi)("data-v-00f74e96"),e=e(),(0,a.jt)(),e),he=pe((()=>(0,a.Lk)("h2",null,"Upload Documents",-1))),me={ref:"video",width:"320",height:"240",autoplay:""},ge={ref:"canvas",width:"320",height:"240",style:{display:"none"}},fe=["src"],ve=pe((()=>(0,a.Lk)("button",{type:"submit"},"Upload Documents",-1))),ye={key:0,class:"popup"},be={class:"popup-content"};function ke(e,t,o,s,n,i){return(0,a.uX)(),(0,a.CE)("div",null,[he,(0,a.Lk)("form",{onSubmit:t[2]||(t[2]=(0,r.D$)(((...e)=>i.uploadDocuments&&i.uploadDocuments(...e)),["prevent"])),enctype:"multipart/form-data"},[(0,a.Lk)("div",null,[(0,a.Lk)("video",me,null,512),(0,a.Lk)("canvas",ge,null,512),(0,a.Lk)("button",{type:"button",onClick:t[0]||(t[0]=(...e)=>i.capturePhoto&&i.capturePhoto(...e))},"Capture Photo"),n.capturedImage?((0,a.uX)(),(0,a.CE)("img",{key:0,src:n.capturedImage,alt:"Captured photo"},null,8,fe)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",null,[(0,a.Lk)("input",{type:"file",onChange:t[1]||(t[1]=e=>i.handleFileUpload("license",e)),required:""},null,32)]),ve],32),n.showPopup?((0,a.uX)(),(0,a.CE)("div",ye,[(0,a.Lk)("div",be,[(0,a.Lk)("h3",null,(0,P.v_)(n.popupTitle),1),(0,a.Lk)("p",null,(0,P.v_)(n.popupMessage),1),(0,a.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>i.closePopup&&i.closePopup(...e))},"Close")])])):(0,a.Q3)("",!0)])}o(6573),o(8100),o(7936),o(7467),o(4732),o(9577),o(4979);var Le={data(){return{photo:null,license:null,capturedImage:null,stream:null,showPopup:!1,popupTitle:"",popupMessage:""}},mounted(){this.startCamera()},beforeUnmount(){this.stopCamera()},methods:{startCamera(){navigator.mediaDevices.getUserMedia({video:!0}).then((e=>{this.stream=e,this.$refs.video.srcObject=e})).catch((e=>{console.error("Error accessing camera:",e),this.showErrorPopup("Camera Error","Unable to access camera. Please make sure you've granted permission.")}))},stopCamera(){this.stream&&this.stream.getTracks().forEach((e=>e.stop()))},capturePhoto(){const e=this.$refs.canvas.getContext("2d");e.drawImage(this.$refs.video,0,0,320,240),this.capturedImage=this.$refs.canvas.toDataURL("image/jpeg"),this.photo=this.dataURLtoFile(this.capturedImage,"captured_photo.jpg")},dataURLtoFile(e,t){let o=e.split(","),r=o[0].match(/:(.*?);/)[1],a=atob(o[1]),s=a.length,n=new Uint8Array(s);while(s--)n[s]=a.charCodeAt(s);return new File([n],t,{type:r})},handleFileUpload(e,t){this[e]=t.target.files[0]},async uploadDocuments(){if(!this.photo||!this.license)return void this.showErrorPopup("Missing Documents","Please capture a photo and upload a license document.");const e=localStorage.getItem("access_token"),t=new FormData;t.append("photo",this.photo),t.append("license",this.license);try{const o=await m.post("/user_document",t,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"multipart/form-data"}});console.log(o.data),"User document added successfully"===o.data.message?(this.showSuccessPopup("Success","Documents uploaded successfully!"),setTimeout((()=>{this.$router.push("/dashboard")}),2e3)):this.showErrorPopup("Upload Failed",o.data.verification_summary||"Failed to upload documents. Please try again.")}catch(o){console.error("Error uploading documents:",o),console.error("Error response:",o.response),console.error("Error data:",o.response?.data),this.showErrorPopup("Upload Failed",o.response?.data?.detail||"Failed to upload documents. Please try again.")}},showSuccessPopup(e,t){this.popupTitle=e,this.popupMessage=t,this.showPopup=!0},showErrorPopup(e,t){this.popupTitle=e,this.popupMessage=t,this.showPopup=!0},closePopup(){this.showPopup=!1}}};const we=(0,d.A)(Le,[["render",ke],["__scopeId","data-v-00f74e96"]]);var Ue=we;const _e=e=>((0,a.Qi)("data-v-35377922"),e=e(),(0,a.jt)(),e),Ce=_e((()=>(0,a.Lk)("h2",null,"Verify OTP",-1))),Ee=_e((()=>(0,a.Lk)("button",{type:"submit"},"Verify OTP",-1)));function Pe(e,t,o,s,n,i){return(0,a.uX)(),(0,a.CE)("div",null,[Ce,(0,a.Lk)("form",{onSubmit:t[1]||(t[1]=(0,r.D$)(((...e)=>i.verifyOTP&&i.verifyOTP(...e)),["prevent"]))},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.otp=e),type:"text",placeholder:"Enter OTP",required:""},null,512),[[r.Jo,n.otp]]),Ee],32)])}var De={data(){return{otp:""}},methods:{async verifyOTP(){try{const e=localStorage.getItem("session_id");if(!e)throw new Error("Session ID not found");const t=await m.post("/verify_otp",{otp:this.otp,session_id:e});if("User created successfully"!==t.data)throw new Error("Unexpected response from server");alert("OTP verified successfully!"),localStorage.removeItem("session_id"),this.$router.push("/login")}catch(e){console.error("OTP verification error:",e.response?.data?.detail||e.message),alert("OTP verification failed: "+(e.response?.data?.detail||"Unknown error"))}}}};const Ae=(0,d.A)(De,[["render",Pe],["__scopeId","data-v-35377922"]]);var Se=Ae;const Ie=[{path:"/login",component:k},{path:"/new-user",component:E},{path:"/dashboard",component:J},{path:"/user-details",component:H},{path:"/user-address",component:ae},{path:"/user-income",component:ce},{path:"/user-document",component:Ue},{path:"/verify-otp",component:Se},{path:"*",redirect:"/login"}],Oe=(0,c.aE)({history:(0,c.LA)(),routes:Ie});async function $e(){try{const e=await m.get("/check_user_state");return e.data}catch(e){return console.error("Error checking user state:",e),null}}Oe.beforeEach((async(e,t,o)=>{const r=await $e();switch(r){case"user":o("/user-address");break;case"address":o("/user-income");break;case"income":o("/user-document");break;case"documents":o("/dashboard");break;default:o("/login");break}}));var xe=Oe;p.A.defaults.baseURL="http://localhost:8000";const Te=(0,r.Ef)(u);Te.config.globalProperties.$http=p.A,Te.use(xe),Te.mount("#app")}},t={};function o(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,o),s.exports}o.m=e,function(){var e=[];o.O=function(t,r,a,s){if(!r){var n=1/0;for(u=0;u<e.length;u++){r=e[u][0],a=e[u][1],s=e[u][2];for(var i=!0,d=0;d<r.length;d++)(!1&s||n>=s)&&Object.keys(o.O).every((function(e){return o.O[e](r[d])}))?r.splice(d--,1):(i=!1,s<n&&(n=s));if(i){e.splice(u--,1);var l=a();void 0!==l&&(t=l)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[r,a,s]}}(),function(){o.d=function(e,t){for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,r){var a,s,n=r[0],i=r[1],d=r[2],l=0;if(n.some((function(t){return 0!==e[t]}))){for(a in i)o.o(i,a)&&(o.m[a]=i[a]);if(d)var u=d(o)}for(t&&t(r);l<n.length;l++)s=n[l],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(u)},r=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=o.O(void 0,[504],(function(){return o(5399)}));r=o.O(r)})();
//# sourceMappingURL=app.bb19df57.js.map